
<button id="btn">
    click me!
</button>

<button id="btn-p">
    get pub sub messages!
</button>


<button id="btn2">
    send hello via pub sub push!
</button>

<button id="btn3">
    send hello via pub sub pull!
</button>

<script>
    function request() {
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function () {
            if (xhr.readyState === 4) {
                console.log(xhr.response);
                const obj = JSON.parse(xhr.response)
                console.log(obj.key);
            }
        }
        xhr.open('get', '/j', true);
        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded; charset=UTF-8');
        xhr.send();
    }

    document.getElementById("btn").onclick = function() {
        request()
    };

    function request_p() {
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function () {
            if (xhr.readyState === 4) {
                console.log(xhr.response);
                const obj = JSON.parse(xhr.response)
                console.log(obj.key);
            }
        }
        xhr.open('get', '/pmsgs', true);
        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded; charset=UTF-8');
        xhr.send();
    }

    document.getElementById("btn-p").onclick = function() {
        request_p()
    };

    function pubsub_send() {
        var xhr = new XMLHttpRequest();
        xhr.open("POST", 'https://pubsub.googleapis.com/v1/projects/groovy-autumn-290918/topics/my-first-topic:publish', true);
        xhr.setRequestHeader('Content-Type', 'application/json');
        xhr.setRequestHeader('Authorization', 'Bearer ya29.A0AVA9y1u7rlNEWYe2UFm7-EK1cZvTKJL74qB2N9LsYPvM4p14gKhFSsjrfhdS_EopYeWuq7c9tCdv3LsQJqwr6U0K5pw5Rq3mqq5wwsDdAz5YY97_y3RkuTN315oRFoVG-Vnq_o_Mhd801cNJ5z6aK3IIHs3XxOREJlH2aXJJrOUJnY9F1Zrf3RjOBdWJk5BIPnCbwwtTk2LhLCx8gUFl5sviLtmb8kwZNkDDJHzWq0YlLcP4ia05HFE3iIbDHbZ7iLLSX3vrdAYUNnWUtBVEFTQVRBU0ZRRTY1ZHI4TFZZNXFPYnh3cXNmYlc1NF93TGowdw0273');
        xhr.send(JSON.stringify({
            "messages": [
                {
                "attributes": {
                    "KEY1": "VALUE1",
                },
                "data": btoa("hello from pubsub"),
                }
            ]
        }));
    }

    document.getElementById("btn2").onclick = function() {
        pubsub_send()
    };

    function pubsub_send_pull() {
        var xhr = new XMLHttpRequest();
        xhr.open("POST", 'https://pubsub.googleapis.com/v1/projects/groovy-autumn-290918/topics/my-first-topic:publish', true);
        xhr.setRequestHeader('Content-Type', 'application/json');
        xhr.setRequestHeader('Authorization',
         'Bearer ya29.A0AVA9y1u7rlNEWYe2UFm7-EK1cZvTKJL74qB2N9LsYPvM4p14gKhFSsjrfhdS_EopYeWuq7c9tCdv3LsQJqwr6U0K5pw5Rq3mqq5wwsDdAz5YY97_y3RkuTN315oRFoVG-Vnq_o_Mhd801cNJ5z6aK3IIHs3XxOREJlH2aXJJrOUJnY9F1Zrf3RjOBdWJk5BIPnCbwwtTk2LhLCx8gUFl5sviLtmb8kwZNkDDJHzWq0YlLcP4ia05HFE3iIbDHbZ7iLLSX3vrdAYUNnWUtBVEFTQVRBU0ZRRTY1ZHI4TFZZNXFPYnh3cXNmYlc1NF93TGowdw0273');
        xhr.send(JSON.stringify({
            "messages": [
                {
                "attributes": {
                    "KEY1": "VALUE1",
                },
                "data": btoa("hello from pubsub pull"),
                }
            ]
        }));
    }

    document.getElementById("btn3").onclick = function() {
        pubsub_send_pull()
    };
</script>